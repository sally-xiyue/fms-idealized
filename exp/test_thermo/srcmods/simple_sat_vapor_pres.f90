
module simple_sat_vapor_pres_mod

!-----------------------------------------------------------------------
!
!                 simple saturation vapor pressure
!
!      routines for computing the saturation vapor pressure (es) and
!      the derivative of es with respect to temperature
!
!      uses a simple formula based on constant latent heat
!
!-----------------------------------------------------------------------
!
!                               usage
!                               -----
!
!                       call lookup_es  (temp,es)
!
!                       call lookup_des (temp,des)
!
!    arguments
!    ---------
!      temp    intent in       temperature in degrees kelvin
!      es      intent out      saturation vapor pressure in Pascals
!      des     intent out      derivative of saturation vapor pressure
!                              with respect to temperature (Pascals/degree)
!
!-----------------------------------------------------------------------

 use        fms_mod, only:  write_version_number,   &
                            error_mesg, FATAL
 !
 ! use      constants_mod, only:  hlv,rvgas


implicit none
private

 public :: lookup_es, lookup_des
 public :: escomp, descomp ! for backward compatibility
                           ! use lookup_es, lookup_des instead



! ! !-----------------------------------------------------------------------
 interface lookup_es
   module procedure lookup_es_0d, lookup_es_1d, lookup_es_2d, lookup_es_3d
 end interface
 ! for backward compatibility (to be removed soon)
 interface escomp
  module procedure lookup_es_0d, lookup_es_1d, lookup_es_2d, lookup_es_3d
end interface
!-----------------------------------------------------------------------
interface lookup_des
  module procedure lookup_des_0d, lookup_des_1d, lookup_des_2d, lookup_des_3d
end interface
! for backward compatibility (to be removed soon)
interface descomp
  module procedure lookup_des_0d, lookup_des_1d, lookup_des_2d, lookup_des_3d
end interface
! !-----------------------------------------------------------------------
! !  cvs version and tag name
!
! character(len=128) :: version = '$Id: simple_sat_vapor_pres.f90,v 1.6 2002/07/16 22:56:58 fms Exp $'
! character(len=128) :: tagname = '$Name: havana $'
!
! !-----------------------------------------------------------------------
! module variables
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
! Pre-computed saturation vapor pressure from PyCLES lookup table

real, parameter :: t_table(512) = (/100.15, 100.69765166, 101.24530333, 101.79295499, 102.34060665,&
102.88825832, 103.43590998, 103.98356164, 104.53121331, 105.07886497,&
105.62651663, 106.1741683,  106.72181996, 107.26947162, 107.81712329,&
108.36477495, 108.91242661, 109.46007828, 110.00772994, 110.5553816,&
111.10303327, 111.65068493, 112.19833659, 112.74598826, 113.29363992,&
113.84129159, 114.38894325, 114.93659491, 115.48424658, 116.03189824,&
116.5795499,  117.12720157, 117.67485323, 118.22250489, 118.77015656,&
119.31780822, 119.86545988, 120.41311155, 120.96076321, 121.50841487,&
122.05606654, 122.6037182,  123.15136986, 123.69902153, 124.24667319,&
124.79432485, 125.34197652, 125.88962818, 126.43727984, 126.98493151,&
127.53258317, 128.08023483, 128.6278865,  129.17553816, 129.72318982,&
130.27084149, 130.81849315, 131.36614481, 131.91379648, 132.46144814,&
133.0090998,  133.55675147, 134.10440313, 134.65205479, 135.19970646,&
135.74735812, 136.29500978, 136.84266145, 137.39031311, 137.93796477,&
138.48561644, 139.0332681,  139.58091977, 140.12857143, 140.67622309,&
141.22387476, 141.77152642, 142.31917808, 142.86682975, 143.41448141,&
143.96213307, 144.50978474, 145.0574364,  145.60508806, 146.15273973,&
146.70039139, 147.24804305, 147.79569472, 148.34334638, 148.89099804,&
149.43864971, 149.98630137, 150.53395303, 151.0816047,  151.62925636,&
152.17690802, 152.72455969, 153.27221135, 153.81986301, 154.36751468,&
154.91516634, 155.462818,   156.01046967, 156.55812133, 157.10577299,&
157.65342466, 158.20107632, 158.74872798, 159.29637965, 159.84403131,&
160.39168297, 160.93933464, 161.4869863,  162.03463796, 162.58228963,&
163.12994129, 163.67759295, 164.22524462, 164.77289628, 165.32054795,&
165.86819961, 166.41585127, 166.96350294, 167.5111546,  168.05880626,&
168.60645793, 169.15410959, 169.70176125, 170.24941292, 170.79706458,&
171.34471624, 171.89236791, 172.44001957, 172.98767123, 173.5353229,&
174.08297456, 174.63062622, 175.17827789, 175.72592955, 176.27358121,&
176.82123288, 177.36888454, 177.9165362,  178.46418787, 179.01183953,&
179.55949119, 180.10714286, 180.65479452, 181.20244618, 181.75009785,&
182.29774951, 182.84540117, 183.39305284, 183.9407045,  184.48835616,&
185.03600783, 185.58365949, 186.13131115, 186.67896282, 187.22661448,&
187.77426614, 188.32191781, 188.86956947, 189.41722114, 189.9648728,&
190.51252446, 191.06017613, 191.60782779, 192.15547945, 192.70313112,&
193.25078278, 193.79843444, 194.34608611, 194.89373777, 195.44138943,&
195.9890411,  196.53669276, 197.08434442, 197.63199609, 198.17964775,&
198.72729941, 199.27495108, 199.82260274, 200.3702544,  200.91790607,&
201.46555773, 202.01320939, 202.56086106, 203.10851272, 203.65616438,&
204.20381605, 204.75146771, 205.29911937, 205.84677104, 206.3944227,&
206.94207436, 207.48972603, 208.03737769, 208.58502935, 209.13268102,&
209.68033268, 210.22798434, 210.77563601, 211.32328767, 211.87093933,&
212.418591,   212.96624266, 213.51389432, 214.06154599, 214.60919765,&
215.15684932, 215.70450098, 216.25215264, 216.79980431, 217.34745597,&
217.89510763, 218.4427593,  218.99041096, 219.53806262, 220.08571429,&
220.63336595, 221.18101761, 221.72866928, 222.27632094, 222.8239726,&
223.37162427, 223.91927593, 224.46692759, 225.01457926, 225.56223092,&
226.10988258, 226.65753425, 227.20518591, 227.75283757, 228.30048924,&
228.8481409,  229.39579256, 229.94344423, 230.49109589, 231.03874755,&
231.58639922, 232.13405088, 232.68170254, 233.22935421, 233.77700587,&
234.32465753, 234.8723092,  235.41996086, 235.96761252, 236.51526419,&
237.06291585, 237.61056751, 238.15821918, 238.70587084, 239.2535225,&
239.80117417, 240.34882583, 240.8964775,  241.44412916, 241.99178082,&
242.53943249, 243.08708415, 243.63473581, 244.18238748, 244.73003914,&
245.2776908,  245.82534247, 246.37299413, 246.92064579, 247.46829746,&
248.01594912, 248.56360078, 249.11125245, 249.65890411, 250.20655577,&
250.75420744, 251.3018591,  251.84951076, 252.39716243, 252.94481409,&
253.49246575, 254.04011742, 254.58776908, 255.13542074, 255.68307241,&
256.23072407, 256.77837573, 257.3260274,  257.87367906, 258.42133072,&
258.96898239, 259.51663405, 260.06428571, 260.61193738, 261.15958904,&
261.7072407,  262.25489237, 262.80254403, 263.35019569, 263.89784736,&
264.44549902, 264.99315068, 265.54080235, 266.08845401, 266.63610568,&
267.18375734, 267.731409,   268.27906067, 268.82671233, 269.37436399,&
269.92201566, 270.46966732, 271.01731898, 271.56497065, 272.11262231,&
272.66027397, 273.20792564, 273.7555773,  274.30322896, 274.85088063,&
275.39853229, 275.94618395, 276.49383562, 277.04148728, 277.58913894,&
278.13679061, 278.68444227, 279.23209393, 279.7797456,  280.32739726,&
280.87504892, 281.42270059, 281.97035225, 282.51800391, 283.06565558,&
283.61330724, 284.1609589,  284.70861057, 285.25626223, 285.80391389,&
286.35156556, 286.89921722, 287.44686888, 287.99452055, 288.54217221,&
289.08982387, 289.63747554, 290.1851272,  290.73277886, 291.28043053,&
291.82808219, 292.37573386, 292.92338552, 293.47103718, 294.01868885,&
294.56634051, 295.11399217, 295.66164384, 296.2092955,  296.75694716,&
297.30459883, 297.85225049, 298.39990215, 298.94755382, 299.49520548,&
300.04285714, 300.59050881, 301.13816047, 301.68581213, 302.2334638,&
302.78111546, 303.32876712, 303.87641879, 304.42407045, 304.97172211,&
305.51937378, 306.06702544, 306.6146771,  307.16232877, 307.70998043,&
308.25763209, 308.80528376, 309.35293542, 309.90058708, 310.44823875,&
310.99589041, 311.54354207, 312.09119374, 312.6388454,  313.18649706,&
313.73414873, 314.28180039, 314.82945205, 315.37710372, 315.92475538,&
316.47240705, 317.02005871, 317.56771037, 318.11536204, 318.6630137,&
319.21066536, 319.75831703, 320.30596869, 320.85362035, 321.40127202,&
321.94892368, 322.49657534, 323.04422701, 323.59187867, 324.13953033,&
324.687182  , 325.23483366, 325.78248532, 326.33013699, 326.87778865,&
327.42544031, 327.97309198, 328.52074364, 329.0683953,  329.61604697,&
330.16369863, 330.71135029, 331.25900196, 331.80665362, 332.35430528,&
332.90195695, 333.44960861, 333.99726027, 334.54491194, 335.0925636,&
335.64021526, 336.18786693, 336.73551859, 337.28317025, 337.83082192,&
338.37847358, 338.92612524, 339.47377691, 340.02142857, 340.56908023,&
341.1167319,  341.66438356, 342.21203523, 342.75968689, 343.30733855,&
343.85499022, 344.40264188, 344.95029354, 345.49794521, 346.04559687,&
346.59324853, 347.1409002,  347.68855186, 348.23620352, 348.78385519,&
349.33150685, 349.87915851, 350.42681018, 350.97446184, 351.5221135,&
352.06976517, 352.61741683, 353.16506849, 353.71272016, 354.26037182,&
354.80802348, 355.35567515, 355.90332681, 356.45097847, 356.99863014,&
357.5462818,  358.09393346, 358.64158513, 359.18923679, 359.73688845,&
360.28454012, 360.83219178, 361.37984344, 361.92749511, 362.47514677,&
363.02279843, 363.5704501,  364.11810176, 364.66575342, 365.21340509,&
365.76105675, 366.30870841, 366.85636008, 367.40401174, 367.95166341,&
368.49931507, 369.04696673, 369.5946184,  370.14227006, 370.68992172,&
371.23757339, 371.78522505, 372.33287671, 372.88052838, 373.42818004,&
373.9758317,  374.52348337, 375.07113503, 375.61878669, 376.16643836,&
376.71409002, 377.26174168, 377.80939335, 378.35704501, 378.90469667,&
379.45234834, 380.0 /)

real, parameter :: es_table(512) = (/ 1.00000000e-11,  1.00000000e-11,  1.00000000e-11,  1.00000000e-11,&
   1.00000000e-11,  1.00000000e-11,  1.00000000e-11,  1.00000000e-11,&
   1.00000000e-11, 1.00000000e-11, 1.00000000e-11, 1.00000000e-11,&
   1.00000000e-11, 1.00000000e-11, 1.00000000e-11, 1.00000000e-11,&
   1.00000000e-11, 1.00000000e-11, 1.00000000e-11, 1.00000000e-11,&
   1.00000000e-11, 1.00000000e-11, 1.00000000e-11, 1.04431694e-11,&
   1.35878670e-11, 1.76347924e-11, 2.28299687e-11, 2.94830001e-11,&
   3.79825947e-11, 4.88156526e-11, 6.25906869e-11, 8.00665005e-11,&
   1.02187219e-10, 1.30125003e-10, 1.65332008e-10, 2.09603473e-10,&
   2.65154155e-10, 3.34710762e-10, 4.21623499e-10, 5.30000424e-10,&
   6.64868978e-10, 8.32369796e-10, 1.03998884e-09, 1.29683494e-09,&
   1.61397089e-09, 2.00480804e-09, 2.48557530e-09, 3.07587602e-09,&
   3.79934781e-09, 4.68444322e-09, 5.76535159e-09, 7.08308621e-09,&
   8.68676392e-09, 1.06351092e-08, 1.29982190e-08, 1.58596306e-08,&
   1.93187404e-08, 2.34936295e-08, 2.85243589e-08, 3.45768073e-08,&
   4.18471333e-08, 5.05669578e-08, 6.10093728e-08, 7.34958986e-08,&
   8.84045297e-08, 1.06179025e-07, 1.27339619e-07, 1.52495362e-07,&
   1.82358310e-07, 2.17759819e-07, 2.59669247e-07, 3.09215371e-07,&
   3.67710899e-07, 4.36680483e-07, 5.17892689e-07, 6.13396453e-07,&
   7.25562586e-07, 8.57130984e-07, 1.01126426e-06, 1.19160861e-06,&
   1.40236276e-06, 1.64835609e-06, 1.93513697e-06, 2.26907245e-06,&
   2.65746094e-06, 3.10865906e-06, 3.63222456e-06, 4.23907706e-06,&
   4.94167869e-06, 5.75423689e-06, 6.69293175e-06, 7.77617077e-06,&
   9.02487402e-06, 1.04627928e-05, 1.21168660e-05, 1.40176171e-05,&
   1.61995975e-05, 1.87018798e-05, 2.15686073e-05, 2.48496044e-05,&
   2.86010545e-05, 3.28862535e-05, 3.77764439e-05, 4.33517397e-05,&
   4.97021504e-05, 5.69287125e-05, 6.51447410e-05, 7.44772107e-05,&
   8.50682803e-05, 9.70769720e-05, 1.10681022e-04, 1.26078916e-04,&
   1.43492132e-04, 1.63167594e-04, 1.85380382e-04, 2.10436691e-04,&
   2.38677081e-04, 2.70480039e-04, 3.06265875e-04, 3.46500984e-04,&
   3.91702507e-04, 4.42443421e-04, 4.99358092e-04, 5.63148336e-04,&
   6.34590025e-04, 7.14540280e-04, 8.03945303e-04, 9.03848893e-04,&
   1.01540171e-03, 1.13987133e-03, 1.27865315e-03, 1.43328229e-03,&
   1.60544636e-03, 1.79699944e-03, 2.00997711e-03, 2.24661278e-03,&
   2.50935534e-03, 2.80088817e-03, 3.12414981e-03, 3.48235611e-03,&
   3.87902428e-03, 4.31799870e-03, 4.80347882e-03, 5.34004916e-03,&
   5.93271164e-03, 6.58692029e-03, 7.30861868e-03, 8.10428002e-03,&
   8.98095035e-03, 9.94629478e-03, 1.10086472e-02, 1.21770635e-02,&
   1.34613788e-02, 1.48722684e-02, 1.64213132e-02, 1.81210699e-02,&
   1.99851461e-02, 2.20282800e-02, 2.42664260e-02, 2.67168463e-02,&
   2.93982085e-02, 3.23306891e-02, 3.55360852e-02, 3.90379322e-02,&
   4.28616301e-02, 4.70345775e-02, 5.15863145e-02, 5.65486746e-02,&
   6.19559462e-02, 6.78450445e-02, 7.42556937e-02, 8.12306209e-02,&
   8.88157616e-02, 9.70604783e-02, 1.06017791e-01, 1.15744625e-01,&
   1.26302066e-01, 1.37755642e-01, 1.50175609e-01, 1.63637264e-01,&
   1.78221267e-01, 1.94013993e-01, 2.11107888e-01, 2.29601863e-01,&
   2.49601698e-01, 2.71220468e-01, 2.94579005e-01, 3.19806371e-01,&
   3.47040366e-01, 3.76428056e-01, 4.08126341e-01, 4.42302541e-01,&
   4.79135018e-01, 5.18813836e-01, 5.61541445e-01, 6.07533410e-01,&
   6.57019171e-01, 7.10242848e-01, 7.67464078e-01, 8.28958906e-01,&
   8.95020708e-01, 9.65961172e-01, 1.04211132e+00, 1.12382257e+00,&
   1.21146789e+00, 1.30544294e+00, 1.40616735e+00, 1.51408597e+00,&
   1.62967027e+00, 1.75341975e+00, 1.88586338e+00, 2.02756124e+00,&
   2.17910608e+00, 2.34112503e+00, 2.51428142e+00, 2.69927660e+00,&
   2.89685188e+00, 3.10779057e+00, 3.33292012e+00, 3.57311428e+00,&
   3.82929545e+00, 4.10243705e+00, 4.39356606e+00, 4.70376563e+00,&
   5.03417776e+00, 5.38600621e+00, 5.76051941e+00, 6.15905356e+00,&
   6.58301582e+00, 7.03388768e+00, 7.51322840e+00, 8.02267864e+00,&
   8.56396422e+00, 9.13890000e+00, 9.74939400e+00, 1.03974515e+01,&
   1.10851797e+01, 1.18147918e+01, 1.25886123e+01, 1.34090813e+01,&
   1.42787602e+01, 1.52003366e+01, 1.61766298e+01, 1.72105966e+01,&
   1.83053373e+01, 1.94641013e+01, 2.06902944e+01, 2.19790653e+01,&
   2.33282240e+01, 2.47452937e+01, 2.62345742e+01, 2.77999453e+01,&
   2.94452092e+01, 3.11741989e+01, 3.29908271e+01, 3.48991119e+01,&
   3.69031934e+01, 3.90073458e+01, 4.12159860e+01, 4.35336814e+01,&
   4.59651566e+01, 4.85152999e+01, 5.11891688e+01, 5.39919960e+01,&
   5.69291947e+01, 6.00063645e+01, 6.32292968e+01, 6.66039801e+01,&
   7.01366061e+01, 7.38335748e+01, 7.77015006e+01, 8.17472178e+01,&
   8.59777866e+01, 9.04004990e+01, 9.50228846e+01, 9.98527171e+01,&
   1.04898020e+02, 1.10167073e+02, 1.15668420e+02, 1.21410870e+02,&
   1.27403513e+02, 1.33655717e+02, 1.40177141e+02, 1.46977739e+02,&
   1.54067768e+02, 1.61457795e+02, 1.69158705e+02, 1.77181704e+02,&
   1.85538332e+02, 1.94240468e+02, 2.03300335e+02, 2.12730511e+02,&
   2.22543937e+02, 2.32753921e+02, 2.43374151e+02, 2.54418697e+02,&
   2.65902025e+02, 2.77839001e+02, 2.90244900e+02, 3.03135418e+02,&
   3.16526676e+02, 3.30435227e+02, 3.44878073e+02, 3.59872665e+02,&
   3.75436915e+02, 3.91589208e+02, 4.08348405e+02, 4.25733856e+02,&
   4.43765408e+02, 4.62463417e+02, 4.81848752e+02, 5.01942809e+02,&
   5.22767516e+02, 5.44345350e+02, 5.66699337e+02, 5.89853070e+02,&
   6.13832479e+02, 6.38680126e+02, 6.64428306e+02, 6.91105655e+02,&
   7.18741584e+02, 7.47366296e+02, 7.77010802e+02, 8.07706940e+02,&
   8.39487391e+02, 8.72385701e+02, 9.06436294e+02, 9.41674493e+02,&
   9.78136541e+02, 1.01585962e+03, 1.05488185e+03, 1.09524236e+03,&
   1.13698125e+03, 1.18013965e+03, 1.22475971e+03, 1.27088465e+03,&
   1.31855878e+03, 1.36782749e+03, 1.41873729e+03, 1.47133586e+03,&
   1.52567202e+03, 1.58179580e+03, 1.63975842e+03, 1.69961236e+03,&
   1.76141133e+03, 1.82521036e+03, 1.89106576e+03, 1.95903516e+03,&
   2.02917759e+03, 2.10155342e+03, 2.17622445e+03, 2.25325390e+03,&
   2.33270645e+03, 2.41464828e+03, 2.49914707e+03, 2.58627203e+03,&
   2.67609395e+03, 2.76868522e+03, 2.86411983e+03, 2.96247343e+03,&
   3.06382336e+03, 3.16824865e+03, 3.27583008e+03, 3.38665020e+03,&
   3.50079334e+03, 3.61834566e+03, 3.73939521e+03, 3.86403187e+03,&
   3.99234750e+03, 4.12443587e+03, 4.26039275e+03, 4.40031593e+03,&
   4.54430523e+03, 4.69246258e+03, 4.84489199e+03, 5.00169966e+03,&
   5.16299393e+03, 5.32888538e+03, 5.49948684e+03, 5.67491343e+03,&
   5.85528257e+03, 6.04071407e+03, 6.23133009e+03, 6.42725527e+03,&
   6.62861668e+03, 6.83554391e+03, 7.04816908e+03, 7.26662689e+03,&
   7.49105466e+03, 7.72159237e+03, 7.95838269e+03, 8.20157100e+03,&
   8.45130548e+03, 8.70773712e+03, 8.97101974e+03, 9.24131008e+03,&
   9.51876777e+03, 9.80355546e+03, 1.00958388e+04, 1.03957865e+04,&
   1.07035703e+04, 1.10193651e+04, 1.13433492e+04, 1.16757038e+04,&
   1.20166136e+04, 1.23662664e+04, 1.27248536e+04, 1.30925699e+04,&
   1.34696133e+04, 1.38561856e+04, 1.42524918e+04, 1.46587407e+04,&
   1.50751447e+04, 1.55019198e+04, 1.59392858e+04, 1.63874661e+04,&
   1.68466882e+04, 1.73171832e+04, 1.77991862e+04, 1.82929363e+04,&
   1.87986766e+04, 1.93166542e+04, 1.98471202e+04, 2.03903301e+04,&
   2.09465435e+04, 2.15160241e+04, 2.20990401e+04, 2.26958640e+04,&
   2.33067727e+04, 2.39320474e+04, 2.45719740e+04, 2.52268429e+04,&
   2.58969490e+04, 2.65825922e+04, 2.72840766e+04, 2.80017114e+04,&
   2.87358106e+04, 2.94866930e+04, 3.02546823e+04, 3.10401073e+04,&
   3.18433016e+04, 3.26646041e+04, 3.35043587e+04, 3.43629147e+04,&
   3.52406264e+04, 3.61378536e+04, 3.70549612e+04, 3.79923198e+04,&
   3.89503054e+04, 3.99292994e+04, 4.09296889e+04, 4.19518666e+04,&
   4.29962308e+04, 4.40631858e+04, 4.51531415e+04, 4.62665137e+04,&
   4.74037242e+04, 4.85652007e+04, 4.97513770e+04, 5.09626930e+04,&
   5.21995946e+04, 5.34625342e+04, 5.47519703e+04, 5.60683678e+04,&
   5.74121978e+04, 5.87839381e+04, 6.01840729e+04, 6.16130931e+04,&
   6.30714960e+04, 6.45597857e+04, 6.60784732e+04, 6.76280760e+04,&
   6.92091188e+04, 7.08221331e+04, 7.24676572e+04, 7.41462369e+04,&
   7.58584247e+04, 7.76047804e+04, 7.93858712e+04, 8.12022714e+04,&
   8.30545628e+04, 8.49433345e+04, 8.68691832e+04, 8.88327131e+04,&
   9.08345360e+04, 9.28752715e+04, 9.49555466e+04, 9.70759966e+04,&
   9.92372642e+04, 1.01440000e+05, 1.03684864e+05, 1.05972521e+05,&
   1.08303648e+05, 1.10678927e+05, 1.13099049e+05, 1.15564715e+05,&
   1.18076632e+05, 1.20635517e+05, 1.23242095e+05, 1.25897099e+05,&
   1.28601272e+05, 1.31355364e+05, 1.34160135e+05, 1.37016354e+05,&
   1.39924797e+05, 1.42886251e+05, 1.45901511e+05, 1.48971382e+05,&
   1.52096676e+05, 1.55278216e+05, 1.58516835e+05, 1.61813373e+05/)

  real, parameter :: des_table(512) = (/6.12116769e-12, 6.05476789e-12, 5.98944267e-12, 5.92516898e-12,&
   5.86192436e-12, 5.79968696e-12, 5.73843551e-12, 5.67814929e-12,&
   5.61880812e-12, 5.56039236e-12, 5.50288287e-12, 5.44626098e-12,&
   5.39050854e-12, 5.33560783e-12, 5.28154159e-12, 5.22829299e-12,&
   5.17584563e-12, 5.12418352e-12, 5.07329105e-12, 5.02315302e-12,&
   4.97375458e-12, 4.92508127e-12, 4.87711895e-12, 5.04389820e-12,&
   6.49944708e-12, 8.35423924e-12, 1.07120700e-11, 1.37022285e-11,&
   1.74853900e-11, 2.22607857e-11, 2.82749050e-11, 3.58320369e-11,&
   4.53070134e-11, 5.71605796e-11, 7.19578978e-11, 9.03907779e-11,&
   1.13304331e-10, 1.41728863e-10, 1.76917973e-10, 2.20393961e-10,&
   2.74001862e-10, 3.39973616e-10, 4.21004144e-10, 5.20341371e-10,&
   6.41892564e-10, 7.90349728e-10, 9.71337222e-10, 1.19158522e-09,&
   1.45913324e-09, 1.78356846e-09, 2.17630454e-09, 2.65090694e-09,&
   3.22347225e-09, 3.91306966e-09, 4.74225383e-09, 5.73766007e-09,&
   6.93069370e-09, 8.35832761e-09, 1.00640234e-08, 1.20987938e-08,&
   1.45224265e-08, 1.74048914e-08, 2.08279568e-08, 2.48870441e-08,&
   2.96933505e-08, 3.53762784e-08, 4.20862101e-08, 4.99976735e-08,&
   5.93129489e-08, 7.02661735e-08, 8.31280066e-08, 9.82109238e-08,&
   1.15875221e-07, 1.36535812e-07, 1.60669915e-07, 1.88825741e-07,&
   2.21632290e-07, 2.59810396e-07, 3.04185164e-07, 3.55699948e-07,&
   4.15432058e-07, 4.84610382e-07, 5.64635133e-07, 6.57099966e-07,&
   7.63816706e-07, 8.86842982e-07, 1.02851306e-06, 1.19147224e-06,&
   1.37871514e-06, 1.59362832e-06, 1.84003766e-06, 2.12226095e-06,&
   2.44516629e-06, 2.81423677e-06, 3.23564212e-06, 3.71631797e-06,&
   4.26405349e-06, 4.88758811e-06, 5.59671830e-06, 6.40241526e-06,&
   7.31695450e-06, 8.35405851e-06, 9.52905357e-06, 1.08590420e-05,&
   1.23630913e-05, 1.40624415e-05, 1.59807323e-05, 1.81442524e-05,&
   2.05822110e-05, 2.33270359e-05, 2.64146983e-05, 2.98850680e-05,&
   3.37822998e-05, 3.81552556e-05, 4.30579636e-05, 4.85501178e-05,&
   5.46976216e-05, 6.15731780e-05, 6.92569309e-05, 7.78371604e-05,&
   8.74110374e-05, 9.80854399e-05, 1.09977839e-04, 1.23217254e-04,&
   1.37945290e-04, 1.54317255e-04, 1.72503368e-04, 1.92690062e-04,&
   2.15081387e-04, 2.39900530e-04, 2.67391443e-04, 2.97820598e-04,&
   3.31478876e-04, 3.68683602e-04, 4.09780718e-04, 4.55147134e-04,&
   5.05193234e-04, 5.60365577e-04, 6.21149781e-04, 6.88073623e-04,&
   7.61710344e-04, 8.42682203e-04, 9.31664258e-04, 1.02938842e-03,&
   1.13664779e-03, 1.25430126e-03, 1.38327846e-03, 1.52458499e-03,&
   1.67930804e-03, 1.84862237e-03, 2.03379663e-03, 2.23620016e-03,&
   2.45731013e-03, 2.69871925e-03, 2.96214385e-03, 3.24943251e-03,&
   3.56257523e-03, 3.90371316e-03, 4.27514887e-03, 4.67935730e-03,&
   5.11899733e-03, 5.59692399e-03, 6.11620152e-03, 6.68011698e-03,&
   7.29219487e-03, 7.95621238e-03, 8.67621565e-03, 9.45653685e-03,&
   1.03018123e-02, 1.12170014e-02, 1.22074069e-02, 1.32786960e-02,&
   1.44369227e-02, 1.56885513e-02, 1.70404812e-02, 1.85000729e-02,&
   2.00751756e-02, 2.17741557e-02, 2.36059277e-02, 2.55799852e-02,&
   2.77064351e-02, 2.99960325e-02, 3.24602173e-02, 3.51111532e-02,&
   3.79617681e-02, 4.10257968e-02, 4.43178250e-02, 4.78533369e-02,&
   5.16487630e-02, 5.57215321e-02, 6.00901243e-02, 6.47741274e-02,&
   6.97942949e-02, 7.51726076e-02, 8.09323376e-02, 8.70981146e-02,&
   9.36959959e-02, 1.00753539e-01, 1.08299879e-01, 1.16365804e-01,&
   1.24983843e-01, 1.34188347e-01, 1.44015581e-01, 1.54503818e-01,&
   1.65693437e-01, 1.77627020e-01, 1.90349463e-01, 2.03908080e-01,&
   2.18352723e-01, 2.33735897e-01, 2.50112882e-01, 2.67541865e-01,&
   2.86084071e-01, 3.05803901e-01, 3.26769075e-01, 3.49050782e-01,&
   3.72723835e-01, 3.97866828e-01, 4.24562307e-01, 4.52896937e-01,&
   4.82961685e-01, 5.14852002e-01, 5.48668016e-01, 5.84514728e-01,&
   6.22502221e-01, 6.62745869e-01, 7.05366559e-01, 7.50490917e-01,&
   7.98251544e-01, 8.48787257e-01, 9.02243344e-01, 9.58771820e-01,&
   1.01853170e+00, 1.08168926e+00, 1.14841835e+00, 1.21890066e+00,&
   1.29332605e+00, 1.37189285e+00, 1.45480819e+00, 1.54228831e+00,&
   1.63455894e+00, 1.73185565e+00, 1.83442418e+00, 1.94252086e+00,&
   2.05641297e+00, 2.17637916e+00, 2.30270985e+00, 2.40474715e+00,&
   2.52409614e+00, 2.65225593e+00, 2.78770444e+00, 2.93011692e+00,&
   3.07948018e+00, 3.23590497e+00, 3.39956432e+00, 3.57066807e+00,&
   3.74945089e+00, 3.93616595e+00, 4.13108146e+00, 4.33447863e+00,&
   4.54665040e+00, 4.76790075e+00, 4.99854421e+00, 5.23890562e+00,&
   5.48931998e+00, 5.75013240e+00, 6.02169810e+00, 6.30438248e+00,&
   6.59856117e+00, 6.90462016e+00, 7.22295588e+00, 7.55397538e+00,&
   7.89809642e+00, 8.25574766e+00, 8.62736877e+00, 9.01341065e+00,&
   9.41433552e+00, 9.83061713e+00, 1.02627409e+01, 1.07112042e+01,&
   1.11765164e+01, 1.16591988e+01, 1.21597856e+01, 1.26788231e+01,&
   1.32168705e+01, 1.37744999e+01, 1.43522965e+01, 1.49508586e+01,&
   1.55707983e+01, 1.62127408e+01, 1.68773255e+01, 1.75652055e+01,&
   1.82770481e+01, 1.90135350e+01, 1.97753623e+01, 2.05632406e+01,&
   2.13778957e+01, 2.22200680e+01, 2.30905133e+01, 2.39900026e+01,&
   2.49193225e+01, 2.58792753e+01, 2.68706789e+01, 2.78943676e+01,&
   2.89511914e+01, 3.00420169e+01, 3.11677271e+01, 3.23292218e+01,&
   3.35274174e+01, 3.47632472e+01, 3.60376619e+01, 3.73516292e+01,&
   3.87061344e+01, 4.01021800e+01, 4.15407867e+01, 4.30229926e+01,&
   4.45661649e+01, 4.61848393e+01, 4.78551049e+01, 4.95783612e+01,&
   5.13560386e+01, 5.31895982e+01, 5.50805333e+01, 5.70303689e+01,&
   5.90406628e+01, 6.11130061e+01, 6.32490233e+01, 6.54503732e+01,&
   6.77187492e+01, 7.00558799e+01, 7.24635298e+01, 7.49434992e+01,&
   7.74976256e+01, 8.01277835e+01, 8.28358854e+01, 8.56238819e+01,&
   8.84937628e+01, 9.14475572e+01, 9.44873340e+01, 9.76152030e+01,&
   1.00833315e+02, 1.04143862e+02, 1.07549078e+02, 1.11051241e+02,&
   1.14652672e+02, 1.18355734e+02, 1.22162837e+02, 1.26076434e+02,&
   1.30099026e+02, 1.34233157e+02, 1.38481420e+02, 1.42846455e+02,&
   1.47330949e+02, 1.51937639e+02, 1.56669309e+02, 1.61528794e+02,&
   1.66518980e+02, 1.71642801e+02, 1.76903247e+02, 1.82303355e+02,&
   1.87846218e+02, 1.93534981e+02, 1.99372842e+02, 2.05363057e+02,&
   2.11508932e+02, 2.17813832e+02, 2.24281177e+02, 2.30914444e+02,&
   2.37717169e+02, 2.44692943e+02, 2.51845418e+02, 2.59178305e+02,&
   2.66695373e+02, 2.74400455e+02, 2.82297441e+02, 2.90390287e+02,&
   2.98683007e+02, 3.07179681e+02, 3.15884452e+02, 3.24801527e+02,&
   3.33935176e+02, 3.43289737e+02, 3.52869613e+02, 3.62679274e+02,&
   3.72723256e+02, 3.83006164e+02, 3.93532671e+02, 4.04307520e+02,&
   4.15335522e+02, 4.26621560e+02, 4.38170586e+02, 4.49987625e+02,&
   4.62077774e+02, 4.74446203e+02, 4.87098153e+02, 5.00038943e+02,&
   5.13273963e+02, 5.26808679e+02, 5.40648633e+02, 5.54799445e+02,&
   5.69266810e+02, 5.84056500e+02, 5.99174366e+02, 6.14626338e+02,&
   6.30418427e+02, 6.46556719e+02, 6.63047385e+02, 6.79896676e+02,&
   6.97110923e+02, 7.14696542e+02, 7.32660028e+02, 7.51007964e+02,&
   7.69747013e+02, 7.88883924e+02, 8.08425532e+02, 8.28378757e+02,&
   8.48750604e+02, 8.69548166e+02, 8.90778624e+02, 9.12449245e+02,&
   9.34567386e+02, 9.57140493e+02, 9.80176099e+02, 1.00368183e+03,&
   1.02766540e+03, 1.05213462e+03, 1.07709739e+03, 1.10256169e+03,&
   1.12853561e+03, 1.15502733e+03, 1.18204511e+03, 1.20959732e+03,&
   1.23769243e+03, 1.26633897e+03, 1.29554561e+03, 1.32532109e+03,&
   1.35567425e+03, 1.38661403e+03, 1.41814947e+03, 1.45028971e+03,&
   1.48304398e+03, 1.51642162e+03, 1.55043205e+03, 1.58508482e+03,&
   1.62038954e+03, 1.65635597e+03, 1.69299393e+03, 1.73031336e+03,&
   1.76832431e+03, 1.80703690e+03, 1.84646140e+03, 1.88660814e+03,&
   1.92748759e+03, 1.96911029e+03, 2.01148691e+03, 2.05462822e+03,&
   2.09854508e+03, 2.14324848e+03, 2.18874949e+03, 2.23505932e+03,&
   2.28218925e+03, 2.33015070e+03, 2.37895516e+03, 2.42861427e+03,&
   2.47913976e+03, 2.53054345e+03, 2.58283730e+03, 2.63603336e+03,&
   2.69014380e+03, 2.74518089e+03, 2.80115702e+03, 2.85808467e+03,&
   2.91597647e+03, 2.97484512e+03, 3.03470346e+03, 3.09556443e+03,&
   3.15744107e+03, 3.22034655e+03, 3.28429415e+03, 3.34929727e+03,&
   3.41536939e+03, 3.48252414e+03, 3.55077525e+03, 3.62013656e+03,&
   3.69062202e+03, 3.76224571e+03, 3.83502181e+03, 3.90896461e+03,&
   3.98408854e+03, 4.06040811e+03, 4.13793798e+03, 4.21669290e+03,&
   4.29668774e+03, 4.37793750e+03, 4.46045726e+03, 4.54426227e+03,&
   4.62936784e+03, 4.71578944e+03, 4.80354262e+03, 4.89264307e+03,&
   4.98310660e+03, 5.07494911e+03, 5.16818664e+03, 5.26283533e+03,&
   5.35891146e+03, 5.45643140e+03, 5.55541165e+03, 5.65586883e+03,&
   5.75781966e+03, 5.86128100e+03, 5.96626981e+03, 6.07280317e+03/)

! real, parameter :: t_table(512) = (/ 173., 173.31702544, 173.63405088, 173.95107632, 174.26810176,&
!   174.5851272,  174.90215264, 175.21917808, 175.53620352, 175.85322896,&
!   176.1702544,  176.48727984, 176.80430528, 177.12133072, 177.43835616,&
!   177.7553816,  178.07240705, 178.38943249, 178.70645793, 179.02348337,&
!   179.34050881, 179.65753425, 179.97455969, 180.29158513, 180.60861057,&
!   180.92563601, 181.24266145, 181.55968689, 181.87671233, 182.19373777,&
!   182.51076321, 182.82778865, 183.14481409, 183.46183953, 183.77886497,&
!   184.09589041, 184.41291585, 184.72994129, 185.04696673, 185.36399217,&
!   185.68101761, 185.99804305, 186.31506849, 186.63209393, 186.94911937,&
!   187.26614481, 187.58317025, 187.90019569, 188.21722114, 188.53424658,&
!   188.85127202, 189.16829746, 189.4853229,  189.80234834, 190.11937378,&
!   190.43639922, 190.75342466, 191.0704501,  191.38747554, 191.70450098,&
!   192.02152642, 192.33855186, 192.6555773,  192.97260274, 193.28962818,&
!   193.60665362, 193.92367906, 194.2407045,  194.55772994, 194.87475538,&
!   195.19178082, 195.50880626, 195.8258317,  196.14285714, 196.45988258,&
!   196.77690802, 197.09393346, 197.4109589,  197.72798434, 198.04500978,&
!   198.36203523, 198.67906067, 198.99608611, 199.31311155, 199.63013699,&
!   199.94716243, 200.26418787, 200.58121331, 200.89823875, 201.21526419,&
!   201.53228963, 201.84931507, 202.16634051, 202.48336595, 202.80039139,&
!   203.11741683, 203.43444227, 203.75146771, 204.06849315, 204.38551859,&
!   204.70254403, 205.01956947, 205.33659491, 205.65362035, 205.97064579,&
!   206.28767123, 206.60469667, 206.92172211, 207.23874755, 207.55577299,&
!   207.87279843, 208.18982387, 208.50684932, 208.82387476, 209.1409002,&
!   209.45792564, 209.77495108, 210.09197652, 210.40900196, 210.7260274,&
!   211.04305284, 211.36007828, 211.67710372, 211.99412916, 212.3111546,&
!   212.62818004, 212.94520548, 213.26223092, 213.57925636, 213.8962818,&
!   214.21330724, 214.53033268, 214.84735812, 215.16438356, 215.481409,&
!   215.79843444, 216.11545988, 216.43248532, 216.74951076, 217.0665362,&
!   217.38356164, 217.70058708, 218.01761252, 218.33463796, 218.65166341,&
!   218.96868885, 219.28571429, 219.60273973, 219.91976517, 220.23679061,&
!   220.55381605, 220.87084149, 221.18786693, 221.50489237, 221.82191781,&
!   222.13894325, 222.45596869, 222.77299413, 223.09001957, 223.40704501,&
!   223.72407045, 224.04109589, 224.35812133, 224.67514677, 224.99217221,&
!   225.30919765, 225.62622309, 225.94324853, 226.26027397, 226.57729941,&
!   226.89432485, 227.21135029, 227.52837573, 227.84540117, 228.16242661,&
!   228.47945205, 228.7964775,  229.11350294, 229.43052838, 229.74755382,&
!   230.06457926, 230.3816047,  230.69863014, 231.01565558, 231.33268102,&
!   231.64970646, 231.9667319,  232.28375734, 232.60078278, 232.91780822,&
!   233.23483366, 233.5518591,  233.86888454, 234.18590998, 234.50293542,&
!   234.81996086, 235.1369863,  235.45401174, 235.77103718, 236.08806262,&
!   236.40508806, 236.7221135,  237.03913894, 237.35616438, 237.67318982,&
!   237.99021526, 238.3072407,  238.62426614, 238.94129159, 239.25831703,&
!   239.57534247, 239.89236791, 240.20939335, 240.52641879, 240.84344423,&
!   241.16046967, 241.47749511, 241.79452055, 242.11154599, 242.42857143,&
!   242.74559687, 243.06262231, 243.37964775, 243.69667319, 244.01369863,&
!   244.33072407, 244.64774951, 244.96477495, 245.28180039, 245.59882583,&
!   245.91585127, 246.23287671, 246.54990215, 246.86692759, 247.18395303,&
!   247.50097847, 247.81800391, 248.13502935, 248.45205479, 248.76908023,&
!   249.08610568, 249.40313112, 249.72015656, 250.037182,   250.35420744,&
!   250.67123288, 250.98825832, 251.30528376, 251.6223092,  251.93933464,&
!   252.25636008, 252.57338552, 252.89041096, 253.2074364,  253.52446184,&
!   253.84148728, 254.15851272, 254.47553816, 254.7925636,  255.10958904,&
!   255.42661448, 255.74363992, 256.06066536, 256.3776908,  256.69471624,&
!   257.01174168, 257.32876712, 257.64579256, 257.962818,   258.27984344,&
!   258.59686888, 258.91389432, 259.23091977, 259.54794521, 259.86497065,&
!   260.18199609, 260.49902153, 260.81604697, 261.13307241, 261.45009785,&
!   261.76712329, 262.08414873, 262.40117417, 262.71819961, 263.03522505,&
!   263.35225049, 263.66927593, 263.98630137, 264.30332681, 264.62035225,&
!   264.93737769, 265.25440313, 265.57142857, 265.88845401, 266.20547945,&
!   266.52250489, 266.83953033, 267.15655577, 267.47358121, 267.79060665,&
!   268.10763209, 268.42465753, 268.74168297, 269.05870841, 269.37573386,&
!   269.6927593,  270.00978474, 270.32681018, 270.64383562, 270.96086106,&
!   271.2778865,  271.59491194, 271.91193738, 272.22896282, 272.54598826,&
!   272.8630137,  273.18003914, 273.49706458, 273.81409002, 274.13111546,&
!   274.4481409,  274.76516634, 275.08219178, 275.39921722, 275.71624266,&
!   276.0332681,  276.35029354, 276.66731898, 276.98434442, 277.30136986,&
!   277.6183953,  277.93542074, 278.25244618, 278.56947162, 278.88649706,&
!   279.2035225,  279.52054795, 279.83757339, 280.15459883, 280.47162427,&
!   280.78864971, 281.10567515, 281.42270059, 281.73972603, 282.05675147,&
!   282.37377691, 282.69080235, 283.00782779, 283.32485323, 283.64187867,&
!   283.95890411, 284.27592955, 284.59295499, 284.90998043, 285.22700587,&
!   285.54403131, 285.86105675, 286.17808219, 286.49510763, 286.81213307,&
!   287.12915851, 287.44618395, 287.76320939, 288.08023483, 288.39726027,&
!   288.71428571, 289.03131115, 289.34833659, 289.66536204, 289.98238748,&
!   290.29941292, 290.61643836, 290.9334638,  291.25048924, 291.56751468,&
!   291.88454012, 292.20156556, 292.518591,   292.83561644, 293.15264188,&
!   293.46966732, 293.78669276, 294.1037182,  294.42074364, 294.73776908,&
!   295.05479452, 295.37181996, 295.6888454,  296.00587084, 296.32289628,&
!   296.63992172, 296.95694716, 297.2739726,  297.59099804, 297.90802348,&
!   298.22504892, 298.54207436, 298.8590998,  299.17612524, 299.49315068,&
!   299.81017613, 300.12720157, 300.44422701, 300.76125245, 301.07827789,&
!   301.39530333, 301.71232877, 302.02935421, 302.34637965, 302.66340509,&
!   302.98043053, 303.29745597, 303.61448141, 303.93150685, 304.24853229,&
!   304.56555773, 304.88258317, 305.19960861, 305.51663405, 305.83365949,&
!   306.15068493, 306.46771037, 306.78473581, 307.10176125, 307.41878669,&
!   307.73581213, 308.05283757, 308.36986301, 308.68688845, 309.00391389,&
!   309.32093933, 309.63796477, 309.95499022, 310.27201566, 310.5890411,&
!   310.90606654, 311.22309198, 311.54011742, 311.85714286, 312.1741683,&
!   312.49119374, 312.80821918, 313.12524462, 313.44227006, 313.7592955,&
!   314.07632094, 314.39334638, 314.71037182, 315.02739726, 315.3444227,&
!   315.66144814, 315.97847358, 316.29549902, 316.61252446, 316.9295499,&
!   317.24657534, 317.56360078, 317.88062622, 318.19765166, 318.5146771,&
!   318.83170254, 319.14872798, 319.46575342, 319.78277886, 320.09980431,&
!   320.41682975, 320.73385519, 321.05088063, 321.36790607, 321.68493151,&
!   322.00195695, 322.31898239, 322.63600783, 322.95303327, 323.27005871,&
!   323.58708415, 323.90410959, 324.22113503, 324.53816047, 324.85518591,&
!   325.17221135, 325.48923679, 325.80626223, 326.12328767, 326.44031311,&
!   326.75733855, 327.07436399, 327.39138943, 327.70841487, 328.02544031,&
!   328.34246575, 328.65949119, 328.97651663, 329.29354207, 329.61056751,&
!   329.92759295, 330.2446184,  330.56164384, 330.87866928, 331.19569472,&
!   331.51272016, 331.8297456,  332.14677104, 332.46379648, 332.78082192,&
!   333.09784736, 333.4148728,  333.73189824, 334.04892368, 334.36594912,&
!   334.68297456, 335./)

! real, parameter :: es_table(512) = (/ 1.80155028e-03,  1.92237663e-03,  2.05082036e-03,  2.18733035e-03,&
!    2.33238001e-03,  2.48646856e-03,  2.65012227e-03,  2.82389587e-03,&
!    3.00837390e-03,  3.20417225e-03,  3.41193965e-03,  3.63235929e-03,&
!    3.86615053e-03,  4.11407064e-03,  4.37691662e-03,  4.65552714e-03,&
!    4.95078453e-03,  5.26361686e-03,  5.59500012e-03,  5.94596049e-03,&
!    6.31757672e-03,  6.71098258e-03,  7.12736943e-03,  7.56798892e-03,&
!    8.03415580e-03,  8.52725078e-03,  9.04872362e-03,  9.60009625e-03,&
!    1.01829661e-02,  1.07990095e-02,  1.14499852e-02,  1.21377383e-02,&
!    1.28642037e-02,  1.36314106e-02,  1.44414864e-02,  1.52966610e-02,&
!    1.61992715e-02,  1.71517670e-02,  1.81567130e-02,  1.92167972e-02,&
!    2.03348340e-02,  2.15137707e-02,  2.27566926e-02,  2.40668296e-02,&
!    2.54475616e-02,  2.69024254e-02,  2.84351212e-02,  3.00495195e-02,&
!    3.17496681e-02,  3.35397997e-02,  3.54243395e-02,  3.74079133e-02,&
!    3.94953556e-02,  4.16917183e-02,  4.40022794e-02,  4.64325528e-02,&
!    4.89882971e-02,  5.16755259e-02,  5.45005184e-02,  5.74698293e-02,&
!    6.05903004e-02,  6.38690719e-02,  6.73135941e-02,  7.09316398e-02,&
!    7.47313168e-02,  7.87210813e-02,  8.29097513e-02,  8.73065205e-02,&
!    9.19209734e-02,  9.67630996e-02,  1.01843310e-01,  1.07172453e-01,&
!    1.12761830e-01,  1.18623214e-01,  1.24768867e-01,  1.31211559e-01,&
!    1.37964583e-01,  1.45041783e-01,  1.52457565e-01,  1.60226924e-01,&
!    1.68365464e-01,  1.76889420e-01,  1.85815682e-01,  1.95161818e-01,&
!    2.04946098e-01,  2.15187522e-01,  2.25905844e-01,  2.37121599e-01,&
!    2.48856134e-01,  2.61131632e-01,  2.73971146e-01,  2.87398627e-01,&
!    3.01438959e-01,  3.16117987e-01,  3.31462555e-01,  3.47500537e-01,&
!    3.64260876e-01,  3.81773620e-01,  4.00069958e-01,  4.19182262e-01,&
!    4.39144125e-01,  4.59990406e-01,  4.81757269e-01,  5.04482227e-01,&
!    5.28204193e-01,  5.52963520e-01,  5.78802052e-01,  6.05763177e-01,&
!    6.33891870e-01,  6.63234755e-01,  6.93840150e-01,  7.25758131e-01,&
!    7.59040583e-01,  7.93741261e-01,  8.29915851e-01,  8.67622034e-01,&
!    9.06919545e-01,  9.47870244e-01,  9.90538182e-01,  1.03498967e+00,&
!    1.08129335e+00,  1.12952027e+00,  1.17974395e+00,  1.23204050e+00,&
!    1.28648863e+00,  1.34316979e+00,  1.40216823e+00,  1.46357111e+00,&
!    1.52746853e+00,  1.59395371e+00,  1.66312300e+00,  1.73507602e+00,&
!    1.80991576e+00,  1.88774867e+00,  1.96868475e+00,  2.05283769e+00,&
!    2.14032496e+00,  2.23126792e+00,  2.32579193e+00,  2.42402651e+00,&
!    2.52610540e+00,  2.63216672e+00,  2.74235311e+00,  2.85681181e+00,&
!    2.97569487e+00,  3.09915921e+00,  3.22736682e+00,  3.36048485e+00,&
!    3.49868583e+00,  3.64214775e+00,  3.79105426e+00,  3.94559482e+00,&
!    4.10596484e+00,  4.27236589e+00,  4.44500584e+00,  4.62409905e+00,&
!    4.80986652e+00,  5.00253614e+00,  5.20234281e+00,  5.40952866e+00,&
!    5.62434325e+00,  5.84704379e+00,  6.07789530e+00,  6.31717088e+00,&
!    6.56515187e+00,  6.82212810e+00,  7.08839815e+00,  7.36426952e+00,&
!    7.65005889e+00,  7.94609240e+00,  8.25270585e+00,  8.57024497e+00,&
!    8.89906570e+00,  9.23953442e+00,  9.59202827e+00,  9.95693537e+00,&
!    1.03346552e+01,  1.07255987e+01,  1.11301888e+01,  1.15488606e+01,&
!    1.19820616e+01,  1.24302524e+01,  1.28939063e+01,  1.33735105e+01,&
!    1.38695658e+01,  1.43825870e+01,  1.49131038e+01,  1.54616604e+01,&
!    1.60288165e+01,  1.66151471e+01,  1.72212436e+01,  1.78477135e+01,&
!    1.84951812e+01,  1.91642882e+01,  1.98556938e+01,  2.05700751e+01,&
!    2.13066065e+01,  2.20610694e+01,  2.28363950e+01,  2.36339052e+01,&
!    2.44545349e+01,  2.52990989e+01,  2.61683629e+01,  2.70630707e+01,&
!    2.79839592e+01,  2.89317652e+01,  2.99072304e+01,  3.09111045e+01,&
!    3.19441472e+01,  3.30071299e+01,  3.41008367e+01,  3.52260656e+01,&
!    3.63836292e+01,  3.75743552e+01,  3.87990873e+01,  4.00586853e+01,&
!    4.13540260e+01,  4.26860036e+01,  4.40555297e+01,  4.54635344e+01,&
!    4.69109659e+01,  4.83987916e+01,  4.99279981e+01,  5.14995915e+01,&
!    5.31145980e+01,  5.47740642e+01,  5.64790573e+01,  5.82306657e+01,&
!    6.00299993e+01,  6.18781895e+01,  6.37763903e+01,  6.57257777e+01,&
!    6.77275511e+01,  6.97829328e+01,  7.18931689e+01,  7.40595294e+01,&
!    7.62833089e+01,  7.85658263e+01,  8.09084260e+01,  8.33124778e+01,&
!    8.57793774e+01,  8.83105467e+01,  9.09074343e+01,  9.35715159e+01,&
!    9.63042946e+01,  9.91073015e+01,  1.01982096e+02,  1.04930265e+02,&
!    1.07953427e+02,  1.11053228e+02,  1.14231344e+02,  1.17489482e+02,&
!    1.20829380e+02,  1.24252806e+02,  1.27761561e+02,  1.31357477e+02,&
!    1.35042418e+02,  1.38818284e+02,  1.42687004e+02,  1.46650545e+02,&
!    1.50710905e+02,  1.54870118e+02,  1.59130254e+02,  1.63493418e+02,&
!    1.67961750e+02,  1.72537429e+02,  1.77222670e+02,  1.82019724e+02,&
!    1.86930882e+02,  1.91958473e+02,  1.97104866e+02,  2.02372467e+02,&
!    2.07763724e+02,  2.13281125e+02,  2.18927199e+02,  2.24704517e+02,&
!    2.30615691e+02,  2.36663377e+02,  2.42850272e+02,  2.49179119e+02,&
!    2.55652703e+02,  2.62273855e+02,  2.69045452e+02,  2.75970413e+02,&
!    2.83051708e+02,  2.90292350e+02,  2.97695402e+02,  3.05263973e+02,&
!    3.13001222e+02,  3.20910355e+02,  3.28994630e+02,  3.37257354e+02,&
!    3.45701884e+02,  3.54331629e+02,  3.63150050e+02,  3.72160660e+02,&
!    3.81367026e+02,  3.90772766e+02,  4.00381556e+02,  4.10197123e+02,&
!    4.20223253e+02,  4.30463784e+02,  4.40922613e+02,  4.51603695e+02,&
!    4.62511040e+02,  4.73648719e+02,  4.85020861e+02,  4.96631653e+02,&
!    5.08485345e+02,  5.20586246e+02,  5.32938727e+02,  5.45547221e+02,&
!    5.58416224e+02,  5.71550296e+02,  5.84954059e+02,  5.98632190e+02,&
!    6.12590816e+02,  6.26840586e+02,  6.41387672e+02,  6.56237530e+02,&
!    6.71395698e+02,  6.86867802e+02,  7.02659556e+02,  7.18776761e+02,&
!    7.35225308e+02,  7.52011180e+02,  7.69140452e+02,  7.86619290e+02,&
!    8.04453957e+02,  8.22650810e+02,  8.41216302e+02,  8.60156985e+02,&
!    8.79479509e+02,  8.99190626e+02,  9.19297187e+02,  9.39806147e+02,&
!    9.60724564e+02,  9.82059603e+02,  1.00381853e+03,  1.02600873e+03,&
!    1.04863769e+03,  1.07171299e+03,  1.09524236e+03,  1.11923361e+03,&
!    1.14369468e+03,  1.16863361e+03,  1.19405858e+03,  1.21997787e+03,&
!    1.24639989e+03,  1.27333316e+03,  1.30078633e+03,  1.32876817e+03,&
!    1.35728758e+03,  1.38635359e+03,  1.41597534e+03,  1.44616212e+03,&
!    1.47692334e+03,  1.50826854e+03,  1.54020740e+03,  1.57274973e+03,&
!    1.60590549e+03,  1.63968476e+03,  1.67409777e+03,  1.70915489e+03,&
!    1.74486664e+03,  1.78124366e+03,  1.81829677e+03,  1.85603691e+03,&
!    1.89447519e+03,  1.93362285e+03,  1.97349130e+03,  2.01409210e+03,&
!    2.05543695e+03,  2.09753774e+03,  2.14040648e+03,  2.18405537e+03,&
!    2.22849676e+03,  2.27374316e+03,  2.31980727e+03,  2.36670193e+03,&
!    2.41444016e+03,  2.46303515e+03,  2.51250026e+03,  2.56284903e+03,&
!    2.61409517e+03,  2.66625258e+03,  2.71933534e+03,  2.77335768e+03,&
!    2.82833406e+03,  2.88427908e+03,  2.94120758e+03,  2.99913453e+03,&
!    3.05807514e+03,  3.11804479e+03,  3.17905906e+03,  3.24113371e+03,&
!    3.30428473e+03,  3.36852829e+03,  3.43388077e+03,  3.50035875e+03,&
!    3.56797902e+03,  3.63675858e+03,  3.70671462e+03,  3.77786458e+03,&
!    3.85022609e+03,  3.92381700e+03,  3.99865538e+03,  4.07475953e+03,&
!    4.15214795e+03,  4.23083938e+03,  4.31085280e+03,  4.39220740e+03,&
!    4.47492260e+03,  4.55901807e+03,  4.64451370e+03,  4.73142962e+03,&
!    4.81978622e+03,  4.90960410e+03,  5.00090412e+03,  5.09370741e+03,&
!    5.18803530e+03,  5.28390941e+03,  5.38135160e+03,  5.48038399e+03,&
!    5.58102894e+03,  5.68330911e+03,  5.78724737e+03,  5.89286689e+03,&
!    6.00019111e+03,  6.10924373e+03,  6.22004870e+03,  6.33263029e+03,&
!    6.44701300e+03,  6.56322165e+03,  6.68128131e+03,  6.80121735e+03,&
!    6.92305543e+03,  7.04682148e+03,  7.17254174e+03,  7.30024273e+03,&
!    7.42995128e+03,  7.56169450e+03,  7.69549983e+03,  7.83139499e+03,&
!    7.96940801e+03,  8.10956723e+03,  8.25190131e+03,  8.39643921e+03,&
!    8.54321021e+03,  8.69224393e+03,  8.84357028e+03,  8.99721952e+03,&
!    9.15322221e+03,  9.31160927e+03,  9.47241194e+03,  9.63566178e+03,&
!    9.80139071e+03,  9.96963098e+03,  1.01404152e+04,  1.03137763e+04,&
!    1.04897475e+04,  1.06683626e+04,  1.08496554e+04,  1.10336604e+04,&
!    1.12204123e+04,  1.14099460e+04,  1.16022972e+04,  1.17975016e+04,&
!    1.19955953e+04,  1.21966149e+04,  1.24005973e+04,  1.26075799e+04,&
!    1.28176004e+04,  1.30306967e+04,  1.32469074e+04,  1.34662714e+04,&
!    1.36888278e+04,  1.39146163e+04,  1.41436771e+04,  1.43760504e+04,&
!    1.46117772e+04,  1.48508987e+04,  1.50934567e+04,  1.53394931e+04,&
!    1.55890506e+04,  1.58421720e+04,  1.60989007e+04,  1.63592804e+04,&
!    1.66233555e+04,  1.68911704e+04,  1.71627704e+04,  1.74382008e+04,&
!    1.77175078e+04,  1.80007376e+04,  1.82879372e+04,  1.85791539e+04,&
!    1.88744353e+04,  1.91738298e+04,  1.94773860e+04,  1.97851530e+04,&
!    2.00971806e+04,  2.04135187e+04,  2.07342179e+04,  2.10593293e+04,&
!    2.13889044e+04,  2.17229951e+04,  2.20616541e+04,  2.24049341e+04,&
!    2.27528888e+04,  2.31055721e+04,  2.34630385e+04,  2.38253429e+04/)

! real, parameter :: des_table(512) = (/3.69564602e-04,  3.92909210e-04,  4.17632233e-04,  4.43809223e-04,&
!    4.71519539e-04,  5.00846529e-04,  5.31877706e-04,  5.64704937e-04,&
!    5.99424645e-04,  6.36138009e-04,  6.74951181e-04,  7.15975506e-04,&
!    7.59327750e-04,  8.05130346e-04,  8.53511637e-04,  9.04606140e-04,&
!    9.58554810e-04,  1.01550533e-03,  1.07561238e-03,  1.13903796e-03,&
!    1.20595170e-03,  1.27653118e-03,  1.35096225e-03,  1.42943943e-03,&
!    1.51216621e-03,  1.59935548e-03,  1.69122989e-03,  1.78802226e-03,&
!    1.88997601e-03,  1.99734559e-03,  2.11039694e-03,  2.22940792e-03,&
!    2.35466886e-03,  2.48648301e-03,  2.62516707e-03,  2.77105176e-03,&
!    2.92448232e-03,  3.08581914e-03,  3.25543833e-03,  3.43373237e-03,&
!    3.62111069e-03,  3.81800040e-03,  4.02484692e-03,  4.24211473e-03,&
!    4.47028807e-03,  4.70987174e-03,  4.96139181e-03,  5.22539651e-03,&
!    5.50245702e-03,  5.79316834e-03,  6.09815020e-03,  6.41804794e-03,&
!    6.75353353e-03,  7.10530648e-03,  7.47409491e-03,  7.86065658e-03,&
!    8.26577995e-03,  8.69028534e-03,  9.13502603e-03,  9.60088951e-03,&
!    1.00887986e-02,  1.05997130e-02,  1.11346300e-02,  1.16945866e-02,&
!    1.22806603e-02,  1.28939707e-02,  1.35356811e-02,  1.42069998e-02,&
!    1.49091821e-02,  1.56435311e-02,  1.64114003e-02,  1.72141946e-02,&
!    1.80533724e-02,  1.89304474e-02,  1.98469903e-02,  2.08046308e-02,&
!    2.18050599e-02,  2.28500312e-02,  2.39413637e-02,  2.50809436e-02,&
!    2.62707266e-02,  2.75127402e-02,  2.88090860e-02,  3.01619421e-02,&
!    3.15735656e-02,  3.30462953e-02,  3.45825539e-02,  3.61848513e-02,&
!    3.78557867e-02,  3.95980519e-02,  4.14144342e-02,  4.33078190e-02,&
!    4.52811936e-02,  4.73376494e-02,  4.94803861e-02,  5.17127144e-02,&
!    5.40380597e-02,  5.64599654e-02,  5.89820970e-02,  6.16082451e-02,&
!    6.43423297e-02,  6.71884038e-02,  7.01506579e-02,  7.32334234e-02,&
!    7.64411773e-02,  7.97785463e-02,  8.32503114e-02,  8.68614122e-02,&
!    9.06169516e-02,  9.45222009e-02,  9.85826042e-02,  1.02803784e-01,&
!    1.07191545e-01,  1.11751881e-01,  1.16490980e-01,  1.21415228e-01,&
!    1.26531218e-01,  1.31845752e-01,  1.37365848e-01,  1.43098750e-01,&
!    1.49051927e-01,  1.55233085e-01,  1.61650173e-01,  1.68311387e-01,&
!    1.75225178e-01,  1.82400261e-01,  1.89845617e-01,  1.97570507e-01,&
!    2.05584476e-01,  2.13897357e-01,  2.22519288e-01,  2.31460709e-01,&
!    2.40732381e-01,  2.50345385e-01,  2.60311137e-01,  2.70641392e-01,&
!    2.81348258e-01,  2.92444200e-01,  3.03942053e-01,  3.15855030e-01,&
!    3.28196731e-01,  3.40981155e-01,  3.54222708e-01,  3.67936215e-01,&
!    3.82136929e-01,  3.96840544e-01,  4.12063203e-01,  4.27821512e-01,&
!    4.44132551e-01,  4.61013884e-01,  4.78483573e-01,  4.96560188e-01,&
!    5.15262824e-01,  5.34611107e-01,  5.54625213e-01,  5.75325878e-01,&
!    5.96734412e-01,  6.18872714e-01,  6.41763285e-01,  6.65429241e-01,&
!    6.89894332e-01,  7.15182952e-01,  7.41320158e-01,  7.68331680e-01,&
!    7.96243946e-01,  8.25084089e-01,  8.54879969e-01,  8.85660185e-01,&
!    9.17454099e-01,  9.50291846e-01,  9.84204357e-01,  1.01922337e+00,&
!    1.05538147e+00,  1.09271206e+00,  1.13124945e+00,  1.17102880e+00,&
!    1.21208620e+00,  1.25445866e+00,  1.29818415e+00,  1.34330159e+00,&
!    1.38985090e+00,  1.43787301e+00,  1.48740989e+00,  1.53850455e+00,&
!    1.59120109e+00,  1.64554471e+00,  1.70158174e+00,  1.75935966e+00,&
!    1.81892711e+00,  1.88033394e+00,  1.94363123e+00,  2.00887129e+00,&
!    2.07610773e+00,  2.14539545e+00,  2.21679066e+00,  2.29035097e+00,&
!    2.34930129e+00,  2.41182346e+00,  2.48007070e+00,  2.55161765e+00,&
!    2.62586660e+00,  2.70258692e+00,  2.78167837e+00,  2.86310015e+00,&
!    2.94684287e+00,  3.03291561e+00,  3.12133919e+00,  3.21214237e+00,&
!    3.30535961e+00,  3.40102965e+00,  3.49919454e+00,  3.59989907e+00,&
!    3.70319030e+00,  3.80911725e+00,  3.91773070e+00,  4.02908300e+00,&
!    4.14322800e+00,  4.26022088e+00,  4.38011816e+00,  4.50297761e+00,&
!    4.62885822e+00,  4.75782017e+00,  4.88992482e+00,  5.02523467e+00,&
!    5.16381338e+00,  5.30572575e+00,  5.45103770e+00,  5.59981630e+00,&
!    5.75212974e+00,  5.90804737e+00,  6.06763966e+00,  6.23097824e+00,&
!    6.39813588e+00,  6.56918652e+00,  6.74420525e+00,  6.92326836e+00,&
!    7.10645328e+00,  7.29383868e+00,  7.48550440e+00,  7.68153148e+00,&
!    7.88200220e+00,  8.08700006e+00,  8.29660980e+00,  8.51091740e+00,&
!    8.73001011e+00,  8.95397644e+00,  9.18290620e+00,  9.41689046e+00,&
!    9.65602161e+00,  9.90039335e+00,  1.01501007e+01,  1.04052401e+01,&
!    1.06659091e+01,  1.09322068e+01,  1.12042338e+01,  1.14820917e+01,&
!    1.17658838e+01,  1.20557147e+01,  1.23516904e+01,  1.26539183e+01,&
!    1.29625073e+01,  1.32775678e+01,  1.35992116e+01,  1.39275518e+01,&
!    1.42627033e+01,  1.46047822e+01,  1.49539063e+01,  1.53101948e+01,&
!    1.56737686e+01,  1.60447500e+01,  1.64232627e+01,  1.68094323e+01,&
!    1.72033858e+01,  1.76052517e+01,  1.80151603e+01,  1.84332433e+01,&
!    1.88596341e+01,  1.92944678e+01,  1.97378811e+01,  2.01900123e+01,&
!    2.06510014e+01,  2.11209901e+01,  2.16001218e+01,  2.20885414e+01,&
!    2.25863958e+01,  2.30938334e+01,  2.36110045e+01,  2.41380610e+01,&
!    2.46751566e+01,  2.52224469e+01,  2.57800889e+01,  2.63482418e+01,&
!    2.69270664e+01,  2.75167253e+01,  2.81173829e+01,  2.87292056e+01,&
!    2.93523614e+01,  2.99870202e+01,  3.06333539e+01,  3.12915361e+01,&
!    3.19617425e+01,  3.26441504e+01,  3.33389392e+01,  3.40462902e+01,&
!    3.47663865e+01,  3.54994131e+01,  3.62455572e+01,  3.70050078e+01,&
!    3.77779557e+01,  3.85645938e+01,  3.93651172e+01,  4.01797225e+01,&
!    4.10086088e+01,  4.18519768e+01,  4.27100294e+01,  4.35829708e+01,&
!    4.44850970e+01,  4.54144182e+01,  4.63608094e+01,  4.73245381e+01,&
!    4.83058751e+01,  4.93050947e+01,  5.03224748e+01,  5.13582965e+01,&
!    5.24128447e+01,  5.34864075e+01,  5.45792771e+01,  5.56917488e+01,&
!    5.68241219e+01,  5.79766992e+01,  5.91497873e+01,  6.03436966e+01,&
!    6.15587411e+01,  6.27952388e+01,  6.40535114e+01,  6.53338846e+01,&
!    6.66366880e+01,  6.79622551e+01,  6.93109233e+01,  7.06830342e+01,&
!    7.20789334e+01,  7.34989705e+01,  7.49434992e+01,  7.64128775e+01,&
!    7.79074675e+01,  7.94276356e+01,  8.09737522e+01,  8.25461923e+01,&
!    8.41453350e+01,  8.57715639e+01,  8.74252671e+01,  8.91068368e+01,&
!    9.08166699e+01,  9.25551677e+01,  9.43227363e+01,  9.61197859e+01,&
!    9.79467318e+01,  9.98039936e+01,  1.01691996e+02,  1.03611167e+02,&
!    1.05561942e+02,  1.07544759e+02,  1.09560061e+02,  1.11608298e+02,&
!    1.13689921e+02,  1.15805389e+02,  1.17955166e+02,  1.20139720e+02,&
!    1.22359524e+02,  1.24615055e+02,  1.26906798e+02,  1.29235242e+02,&
!    1.31600879e+02,  1.34004210e+02,  1.36445737e+02,  1.38925972e+02,&
!    1.41445429e+02,  1.44004627e+02,  1.46604094e+02,  1.49244360e+02,&
!    1.51925961e+02,  1.54649441e+02,  1.57415347e+02,  1.60224232e+02,&
!    1.63076656e+02,  1.65973183e+02,  1.68914384e+02,  1.71900836e+02,&
!    1.74933119e+02,  1.78011823e+02,  1.81137541e+02,  1.84310872e+02,&
!    1.87532423e+02,  1.90802805e+02,  1.94122637e+02,  1.97492541e+02,&
!    2.00913148e+02,  2.04385094e+02,  2.07909020e+02,  2.11485577e+02,&
!    2.15115418e+02,  2.18799205e+02,  2.22537605e+02,  2.26331293e+02,&
!    2.30180947e+02,  2.34087256e+02,  2.38050912e+02,  2.42072615e+02,&
!    2.46153072e+02,  2.50292996e+02,  2.54493107e+02,  2.58754130e+02,&
!    2.63076800e+02,  2.67461855e+02,  2.71910044e+02,  2.76422120e+02,&
!    2.80998842e+02,  2.85640980e+02,  2.90349307e+02,  2.95124605e+02,&
!    2.99967662e+02,  3.04879275e+02,  3.09860245e+02,  3.14911384e+02,&
!    3.20033509e+02,  3.25227443e+02,  3.30494020e+02,  3.35834077e+02,&
!    3.41248463e+02,  3.46738030e+02,  3.52303641e+02,  3.57946163e+02,&
!    3.63666475e+02,  3.69465460e+02,  3.75344009e+02,  3.81303023e+02,&
!    3.87343408e+02,  3.93466079e+02,  3.99671959e+02,  4.05961978e+02,&
!    4.12337075e+02,  4.18798196e+02,  4.25346295e+02,  4.31982335e+02,&
!    4.38707285e+02,  4.45522123e+02,  4.52427837e+02,  4.59425421e+02,&
!    4.66515877e+02,  4.73700216e+02,  4.80979458e+02,  4.88354630e+02,&
!    4.95826767e+02,  5.03396915e+02,  5.11066124e+02,  5.18835458e+02,&
!    5.26705984e+02,  5.34678782e+02,  5.42754937e+02,  5.50935546e+02,&
!    5.59221712e+02,  5.67614547e+02,  5.76115173e+02,  5.84724720e+02,&
!    5.93444327e+02,  6.02275142e+02,  6.11218322e+02,  6.20275031e+02,&
!    6.29446444e+02,  6.38733745e+02,  6.48138127e+02,  6.57660790e+02,&
!    6.67302947e+02,  6.77065815e+02,  6.86950626e+02,  6.96958616e+02,&
!    7.07091033e+02,  7.17349135e+02,  7.27734188e+02,  7.38247466e+02,&
!    7.48890255e+02,  7.59663849e+02,  7.70569552e+02,  7.81608678e+02,&
!    7.92782549e+02,  8.04092498e+02,  8.15539868e+02,  8.27126009e+02,&
!    8.38852284e+02,  8.50720064e+02,  8.62730730e+02,  8.74885673e+02,&
!    8.87186293e+02,  8.99634002e+02,  9.12230219e+02,  9.24976375e+02,&
!    9.37873911e+02,  9.50924277e+02,  9.64128934e+02,  9.77489352e+02,&
!    9.91007012e+02,  1.00468341e+03,  1.01852003e+03,  1.03251841e+03,&
!    1.04668005e+03,  1.06100649e+03,  1.07549927e+03,  1.09015994e+03,&
!    1.10499008e+03,  1.11999124e+03,  1.13516502e+03,  1.15051301e+03/)

  real, parameter :: dx = t_table(2) - t_table(1)
  real, parameter :: dxi = 1.0 / dx
  real, parameter :: x_min = t_table(1)
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------


contains

!#######################################################################

 subroutine lookup_es_0d ( temp, esat )

 real, intent(in)  :: temp
 real, intent(out) :: esat
 integer :: i, ind
 real :: y1, y2, x1
!-----------------------------------------------

ind = floor((temp - x_min)*dxi)
y1 = es_table(ind)
y2 = es_table(ind + 1)
x1 = x_min + dx * ind
esat = y1 + (temp - x1) * (y2 - y1) * dxi

!-----------------------------------------------

 end subroutine lookup_es_0d

!#######################################################################

 subroutine lookup_es_1d ( temp, esat )

 real, intent(in)  :: temp(:)
 real, intent(out) :: esat(:)
 integer :: i, ind
 real :: y1, y2, x1
!-----------------------------------------------

    do i = 1, size(temp)
      ind = floor((temp(i) - x_min)*dxi)
      y1 = es_table(ind)
      y2 = es_table(ind + 1)
      x1 = x_min + dx * ind
      esat(i) = y1 + (temp(i) - x1) * (y2 - y1) * dxi
    enddo
!-----------------------------------------------

 end subroutine lookup_es_1d

!#######################################################################

 subroutine lookup_es_2d ( temp, esat )

 real, intent(in)  :: temp(:,:)
 real, intent(out) :: esat(:,:)
 integer :: i, j, ind
 real :: y1, y2, x1
!-----------------------------------------------

    do i = 1, size(temp,1)
    do j = 1, size(temp,2)
      ind = floor((temp(i, j) - x_min)*dxi)
      y1 = es_table(ind)
      y2 = es_table(ind + 1)
      x1 = x_min + dx * ind
      esat(i, j) = y1 + (temp(i, j) - x1) * (y2 - y1) * dxi
    enddo
    enddo

!-----------------------------------------------

 end subroutine lookup_es_2d

!#######################################################################

 subroutine lookup_es_3d ( temp, esat )

 real, intent(in)  :: temp(:,:,:)
 real, intent(out) :: esat(:,:,:)
 integer :: i, j, k, ind
 real :: y1, y2, x1
!-----------------------------------------------

    do i = 1, size(temp,1)
    do j = 1, size(temp,2)
    do k = 1, size(temp,3)
      ind = floor((temp(i, j, k) - x_min)*dxi)
      y1 = es_table(ind)
      y2 = es_table(ind + 1)
      x1 = x_min + dx * ind
      esat(i, j, k) = y1 + (temp(i, j, k) - x1) * (y2 - y1) * dxi
    enddo
    enddo
    enddo
!-----------------------------------------------

 end subroutine lookup_es_3d

 !#######################################################################

  subroutine lookup_des_0d ( temp, desat )

  real, intent(in)  :: temp
  real, intent(out) :: desat
  integer :: i, ind
  real :: y1, y2, x1
 !-----------------------------------------------

 ind = floor((temp - x_min)*dxi)
 y1 = des_table(ind)
 y2 = des_table(ind + 1)
 x1 = x_min + dx * ind
 desat = y1 + (temp - x1) * (y2 - y1) * dxi

 !-----------------------------------------------

  end subroutine lookup_des_0d

 !#######################################################################

  subroutine lookup_des_1d ( temp, desat )

  real, intent(in)  :: temp(:)
  real, intent(out) :: desat(:)
  integer :: i, ind
  real :: y1, y2, x1
 !-----------------------------------------------

     do i = 1, size(temp)
       ind = floor((temp(i) - x_min)*dxi)
       y1 = des_table(ind)
       y2 = des_table(ind + 1)
       x1 = x_min + dx * ind
       desat(i) = y1 + (temp(i) - x1) * (y2 - y1) * dxi
     enddo
 !-----------------------------------------------

  end subroutine lookup_des_1d

 !#######################################################################

  subroutine lookup_des_2d ( temp, desat )

  real, intent(in)  :: temp(:,:)
  real, intent(out) :: desat(:,:)
  integer :: i, j, ind
  real :: y1, y2, x1
 !-----------------------------------------------

     do i = 1, size(temp,1)
     do j = 1, size(temp,2)
       ind = floor((temp(i, j) - x_min)*dxi)
       y1 = des_table(ind)
       y2 = des_table(ind + 1)
       x1 = x_min + dx * ind
       desat(i, j) = y1 + (temp(i, j) - x1) * (y2 - y1) * dxi
     enddo
     enddo

 !-----------------------------------------------

  end subroutine lookup_des_2d

 !#######################################################################

  subroutine lookup_des_3d ( temp, desat )

  real, intent(in)  :: temp(:,:,:)
  real, intent(out) :: desat(:,:,:)
  integer :: i, j, k, ind
  real :: y1, y2, x1
 !-----------------------------------------------

     do i = 1, size(temp,1)
     do j = 1, size(temp,2)
     do k = 1, size(temp,3)
       ind = floor((temp(i, j, k) - x_min)*dxi)
       y1 = des_table(ind)
       y2 = des_table(ind + 1)
       x1 = x_min + dx * ind
       desat(i, j, k) = y1 + (temp(i, j, k) - x1) * (y2 - y1) * dxi
     enddo
     enddo
     enddo
 !-----------------------------------------------

  end subroutine lookup_des_3d


end module simple_sat_vapor_pres_mod
